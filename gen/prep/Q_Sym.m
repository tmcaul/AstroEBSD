function SymQuat=Q_Sym(Qi,CrystalType)
%CrystalType = 1 --> cubic, 2 --> hexagonal
%generates the 12 symmetric orientations for hexagonal crystals
%and the 24 for cubic
%gives the quaternion as [w,XYZ]

%precalculate some values
sqrt3i2=sqrt(3)/2;
sqrti2=1/sqrt(2);
qw_2=Qi(1)/2;
qx_2=Qi(2)/2;
qy_2=Qi(3)/2;
qz_2=Qi(4)/2;

switch CrystalType
    case 1 %cubic
        
        SymQuat=[...
            [    Qi(1);                     Qi(2);                     Qi(3);                       Qi(4)],...
            [   (Qi(4) - Qi(2))*sqrti2;   (Qi(1) + Qi(3))*sqrti2; (- Qi(2) - Qi(4))*sqrti2;   (Qi(3) - Qi(1))*sqrti2],...
            [ (- Qi(1) - Qi(3))*sqrti2;   (Qi(4) - Qi(2))*sqrti2;   (Qi(1) - Qi(3))*sqrti2; (- Qi(2) - Qi(4))*sqrti2],...
            [                               -Qi(3);                                Qi(4);                                Qi(1);                               -Qi(2)],...
            [   (Qi(1) - Qi(3))*sqrti2;   (Qi(2) + Qi(4))*sqrti2;   (Qi(1) + Qi(3))*sqrti2;   (Qi(4) - Qi(2))*sqrti2],...
            [   (Qi(1) - Qi(2))*sqrti2;   (Qi(1) + Qi(2))*sqrti2;   (Qi(3) - Qi(4))*sqrti2;   (Qi(3) + Qi(4))*sqrti2],...
            [                               -Qi(2);                                Qi(1);                               -Qi(4);                                Qi(3)],...
            [ (- Qi(1) - Qi(2))*sqrti2;   (Qi(1) - Qi(2))*sqrti2; (- Qi(3) - Qi(4))*sqrti2;   (Qi(3) - Qi(4))*sqrti2],...
            [   (Qi(1) - Qi(4))*sqrti2;   (Qi(2) - Qi(3))*sqrti2;   (Qi(2) + Qi(3))*sqrti2;   (Qi(1) + Qi(4))*sqrti2],...
            [                               -Qi(4);                               -Qi(3);                                Qi(2);                                Qi(1)],...
            [ (- Qi(1) - Qi(4))*sqrti2; (- Qi(2) - Qi(3))*sqrti2;   (Qi(2) - Qi(3))*sqrti2;   (Qi(1) - Qi(4))*sqrti2],...
            [         qw_2 - qx_2 - qy_2 - qz_2;         qw_2 + qx_2 - qy_2 + qz_2;         qw_2 + qx_2 + qy_2 - qz_2;         qw_2 - qx_2 + qy_2 + qz_2],...
            [       - qw_2 - qx_2 - qy_2 - qz_2;         qw_2 - qx_2 - qy_2 + qz_2;         qw_2 + qx_2 - qy_2 - qz_2;         qw_2 - qx_2 + qy_2 - qz_2],...
            [         qw_2 - qx_2 + qy_2 + qz_2;         qw_2 + qx_2 + qy_2 - qz_2;         qy_2 - qx_2 - qw_2 - qz_2;         qx_2 - qw_2 + qy_2 + qz_2],...
            [         qy_2 - qx_2 - qw_2 + qz_2;         qw_2 - qx_2 + qy_2 - qz_2;       - qw_2 - qx_2 - qy_2 - qz_2;         qx_2 - qw_2 + qy_2 - qz_2],...
            [         qw_2 - qx_2 - qy_2 + qz_2;         qw_2 + qx_2 + qy_2 + qz_2;         qw_2 - qx_2 + qy_2 - qz_2;         qy_2 - qx_2 - qw_2 + qz_2],...
            [         qz_2 - qx_2 - qy_2 - qw_2;         qw_2 - qx_2 + qy_2 + qz_2;         qw_2 - qx_2 - qy_2 - qz_2;         qy_2 - qx_2 - qw_2 - qz_2],...
            [         qy_2 - qx_2 - qw_2 - qz_2;         qw_2 - qx_2 - qy_2 - qz_2;         qx_2 - qw_2 - qy_2 - qz_2;         qw_2 + qx_2 + qy_2 - qz_2],...
            [         qw_2 - qx_2 + qy_2 - qz_2;         qw_2 + qx_2 - qy_2 - qz_2;         qx_2 - qw_2 + qy_2 - qz_2;         qw_2 + qx_2 + qy_2 + qz_2],...
            [ (- Qi(2) - Qi(3))*sqrti2;   (Qi(1) + Qi(4))*sqrti2;   (Qi(1) - Qi(4))*sqrti2;   (Qi(3) - Qi(2))*sqrti2],...
            [ (- Qi(3) - Qi(4))*sqrti2;   (Qi(4) - Qi(3))*sqrti2;   (Qi(1) + Qi(2))*sqrti2;   (Qi(1) - Qi(2))*sqrti2],...
            [ (- Qi(2) - Qi(4))*sqrti2;   (Qi(1) - Qi(3))*sqrti2;   (Qi(2) - Qi(4))*sqrti2;   (Qi(1) + Qi(3))*sqrti2],...
            [ (  Qi(3) - Qi(2))*sqrti2;   (Qi(1) - Qi(4))*sqrti2; (- Qi(1) - Qi(4))*sqrti2;   (Qi(2) + Qi(3))*sqrti2],...
            [ (  Qi(4) - Qi(3))*sqrti2;   (Qi(3) + Qi(4))*sqrti2; (  Qi(1) - Qi(2))*sqrti2; (- Qi(1) - Qi(2))*sqrti2]];

    case 2 %hexagonal
        SymQuat=[...
            [                      Qi(1);                      Qi(2);                      Qi(3);                      Qi(4)],...
            [   qz_2 + sqrt3i2*Qi(1);   qy_2 + sqrt3i2*Qi(2);   sqrt3i2*Qi(3) - qx_2;   sqrt3i2*Qi(4) - qw_2],...
            [ - qw_2 - sqrt3i2*Qi(4); - qx_2 - sqrt3i2*Qi(3);   sqrt3i2*Qi(2) - qy_2;   sqrt3i2*Qi(1) - qz_2],...
            [                     -Qi(4);                     -Qi(3);                      Qi(2);                      Qi(1)],...
            [   qw_2 - sqrt3i2*Qi(4);   qx_2 - sqrt3i2*Qi(3);   qy_2 + sqrt3i2*Qi(2);   qz_2 + sqrt3i2*Qi(1)],...
            [   sqrt3i2*Qi(1) - qz_2;   sqrt3i2*Qi(2) - qy_2;   qx_2 + sqrt3i2*Qi(3);   qw_2 + sqrt3i2*Qi(4)],...
            [                     -Qi(2);                      Qi(1);                     -Qi(4);                      Qi(3)],...
            [ - qy_2 - sqrt3i2*Qi(2);   qz_2 + sqrt3i2*Qi(1);   qw_2 - sqrt3i2*Qi(4);   sqrt3i2*Qi(3) - qx_2],...
            [ - qx_2 - sqrt3i2*Qi(3);   qw_2 + sqrt3i2*Qi(4);   sqrt3i2*Qi(1) - qz_2;   qy_2 - sqrt3i2*Qi(2)],...
            [                     -Qi(3);                      Qi(4);                      Qi(1);                     -Qi(2)],...
            [   qx_2 - sqrt3i2*Qi(3);   sqrt3i2*Qi(4) - qw_2;   qz_2 + sqrt3i2*Qi(1); - qy_2 - sqrt3i2*Qi(2)],...
            [   qy_2 - sqrt3i2*Qi(2);   sqrt3i2*Qi(1) - qz_2; - qw_2 - sqrt3i2*Qi(4);   qx_2 + sqrt3i2*Qi(3)]];
        
end